> 万物之始,大道至简,衍化至繁。
>
>　　　　　　　——ifelse(is.element(this, 道德经), 道德经, unknown)

一、背景
提到贝叶斯分类，首先来看下贝叶斯其人，贝叶斯(Thomas Bayes,1701—1761)英国牧师、业余数学家。可别小看了欧洲的牧师，孟德尔，被誉为“遗传学之父”也曾为一名神父，假如你不记得孟德尔是谁，那么你肯定记得高中生物上那个著名的豌豆实验。

具有讽刺意味的是，当初贝叶斯发明概率统计理论是为了证明上帝的存在，而至死这个愿望都没有实现，不过感谢伟大的贝叶斯，因为他的无心插柳，才有了今天的贝叶斯公式。接下来，来一睹贝叶斯公式的风采，

$$P(B|A)=\frac{P(B)P(A|B)}{P(A)}$$


公式看起来是不是很简洁，看起来很有对称美。记得上学那会数学老师的一句话，假如你算出来的答案不够简洁，那么多半这道题你算错了。贝叶斯公式有什么意义呢？**它解决了两个事件条件概率的转换问题**。比如说，已知感冒导致流鼻涕的概率，那么流鼻涕有多大的概率感冒呢？贝叶斯可以解决这类问题。

二、贝叶斯分类

贝叶斯可以解决条件概率转换，可是它怎么与分类联系起来的呢？

还是以刚才的例子加以说明，已知$P(流鼻涕|感冒)$，如何判断一个流鼻涕的人是感冒还是没感冒呢？我们可以根据贝叶斯公式求出$P(感冒|流鼻涕)$和$P(非感冒|流鼻涕)$，然后选择条件概率大的类别，也就是在已知某种条件的情况下哪个类别出现的概率更大我们就选择哪个，这就是贝叶斯的思想基础。

说到贝叶斯分类还有几个问题需要解决：

1. 上面只是一个二值分类，也就是说只有两个类别，那么如果是两个以上的类别呢？同样的道理我们可以求出$$P(B_1|A),P(B_2|A),P(B_3|A)\cdots$$这里$A$为已知条件，$B_1,B_2,B_3\cdots$为类别值，然后取概率最大的类别值。
2. 如果已知条件不止一个属性，二是多个呢，这个时候贝叶斯公式可以写作$$P(B|A_1A_2\cdots)=\frac{P(B)P(A_1A_2\cdots|B)}{P(A_1A_2\cdots)}=\frac{P(B)P(A_1|B)P(A_2|B)\cdots}{P(A_1)P(A_2)\cdots}$$上述公式假设已知条件$A_1,A_2\cdots$相互独立，这也是“朴素”一词的由来。另外，可以看到对于不同的分类，分母都是恒定的，而我们只想找到概率最大的类别，因此可以把分母省略，求条件概率的相对值，$$P(B|A_1A_2\cdots)_{relative}=P(B)P(A_1|B)P(A_2|B)\cdots$$
3. 不知道大家有没有注意到，上面的已知条件都是离散值，如果是连续值呢，对于连续值通常有两种办法，一是将连续值截取为离散值，然后求概率，二是假定离散值服从高斯分布，即$$f(x)=\frac{1}{\sqrt{2\pi}\sigma}exp(-\frac{(x-\mu)^2}{2\sigma^2})$$因为我们只需求概率的相对值，所以这里只需计算属性的概率密度值即可。
4. 还有一个问题，当某个类别下没有某个属性，即$P(A|B)$=0，这会使某些分类最终的概率为0，大大降低分类器的准确性，为了解决这个问题，引入Laplace校准，就是对这些没有的类别计数加1，这样如果训练样本集数量充分大时，并不会对结果产生影响。

如果想更详细的了解贝叶斯分类，请参考这两篇文章[分类算法之朴素贝叶斯分类](http://www.cnblogs.com/leoo2sk/archive/2010/09/17/naive-bayesian-classifier.html)和[朴素贝叶斯分类器的应用](http://www.ruanyifeng.com/blog/2013/12/naive_bayes_classifier.html)。

接下来，我用R语言实现一个分类器并用一些数据集测试分类效果。

三、程序实现

程序主要由三部分组成：

1.基础数据准备

```
# 1.求各个分类概率P(ycol)
get.ytable <- function(ycol, trainset)
# 2.1求离散属性xcol的条件概率P(xcol|ycol)
get.discrete.xtable <- function(xcol, ycol, trainset) 
# 2.2求连续属性xcol的概率密度，假设服从高斯分布
get.continout.xdensity <- function(xcol, ycol, trainset)
# 3.对于某些概率为零的类别，采用Laplace校准设置默认值
get.defaultx <- function(ycol, trainset)
# 注：xcol条件属性，ycol类别属性，trainset训练集
```

2.构造分类器

```
# 将训练集
testset2plist <- function(testset, discrete_xtable, continous.xtable, defaultx)
```
具体的代码见[GitHub](https://github.com/pingao777)
